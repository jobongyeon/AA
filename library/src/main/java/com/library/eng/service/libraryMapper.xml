<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.library.eng">
	<insert id="memberAdd"
			parameterType="com.library.eng.service.Member">
			INSERT INTO member(
				MEMBERID,
				MEMBERPW,
				MEMBERNAME,
				MEMBERBIRTHDAY,
				MEMBERPHONE,
				MEMBERADDR,
				JOINDAY,
				LIBCODE)
			VALUES(
				#{MEMBERID},
				#{MEMBERPW},
				#{MEMBERNAME},
				#{MEMBERBIRTHDAY},
				#{MEMBERPHONE},
				#{MEMBERADDR},
				now(),
				#{LIBCODE}
			)
	</insert>
	<select id="selectMemberAdd"
			resultType="com.library.eng.service.Library">
			SELECT
				LIBNAME,
				LIBCODE
			FROM
				LIB
	</select>
	<select id="selectAdminLogin"
			resultType="com.library.eng.service.Admin"
			parameterType="String">
			SELECT 
				ADMINID, 
				ADMINPW 
			FROM 
				ADMIN 
			WHERE 
				ADMINID=#{ADMINID}
	</select>
	<insert id="libraryAdd"
			parameterType="com.library.eng.service.Library">
			INSERT INTO LIB(
				LIBNAME, 
				LIBLOCATION) 
			VALUES(
				#{LIBNAME},
				#{LIBLOCATION}
				) 
	</insert>
	<insert id="bookAdd"
			parameterType="com.library.eng.service.Books">
			INSERT INTO	BOOKS (
				LIBCODE, 
				BOOKNAME, 
				WRITER, 
				PUBLISHER, 
				CATEGORY, 
				GENRE, 
				BOOKLOCATION)
			VALUES(
				#{LIBCODE},
				#{BOOKNAME},
				#{WRITER},
				#{PUBLISHER},
				#{CATEGORY},
				#{GENRE},
				#{BOOKLOCATION}
				)
	</insert>
	<insert id="bookDelete"
			parameterType="com.library.eng.service.Discardbooks">
			INSERT INTO DISCARDBOOKS(
				BOOKCODE, 
				DISCARDREASON)
			VALUES(
				#{BOOKCODE},
				#{DISCARDREASON}
				)
	</insert>
	<update id="updateBookStatus"
			parameterType="com.library.eng.service.Books">
			UPDATE 
				BOOKS 
			SET 
				CURRENTSTATUS = 'n'
			WHERE  
				BOOKCODE = #{BOOKCODE}
	</update>
	<insert id="insertRental"
			parameterType="com.library.eng.service.Rental">
			INSERT INTO RENTAL(
				BOOKCODE,
				RENTALSTARTDAY,
				RETURNEXPECTDAY,
				MEMBERID,
				RETURNSTATUS)
			VALUES(
				#{BOOKCODE},
				now(),
				date_add(now(), interval 5 day),
				#{MEMBERID},
				'n')
	</insert>
</mapper>