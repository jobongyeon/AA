<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.library.eng">
	<insert id="memberAdd"
			parameterType="com.library.eng.service.Member">
			INSERT INTO member
						(MEMBERID,
						MEMBERPW,
						MEMBERNAME,
						MEMBERBIRTHDAY,
						MEMBERPHONE,
						MEMBERADDR,
						JOINDAY,
						LIBCODE)
			VALUES
						(#{MEMBERID},
						#{MEMBERPW},
						#{MEMBERNAME},
						#{MEMBERBIRTHDAY},
						#{MEMBERPHONE},
						#{MEMBERADDR},
						now(),
						#{LIBCODE})
	</insert>
	<select id="selectMemberAdd"
			resultType="com.library.eng.service.Library">
			SELECT	libname,
					libcode
			FROM	lib
	</select>
	<select id="selectAdminLogin"
			resultType="com.library.eng.service.Admin"
			parameterType="String">
			SELECT 
				ADMINID, 
				ADMINPW 
			FROM 
				admin 
			WHERE 
				ADMINID=#{ADMINID}
	</select>
	<insert id="libraryAdd"
			parameterType="com.library.eng.service.Library">
			INSERT INTO lib(
				LIBNAME, 
				LIBLOCATION) 
			VALUES(
				#{LIBNAME},
				#{LIBLOCATION}
				) 
	</insert>
	<insert id="bookAdd"
			parameterType="com.library.eng.service.Books">
			INSERT INTO	books (
				LIBCODE, 
				BOOKNAME, 
				WRITER, 
				PUBLISHER, 
				CATEGORY, 
				GENRE, 
				BOOKLOCATION)
			VALUES(
				#{LIBCODE},
				#{BOOKNAME},
				#{WRITER},
				#{PUBLISHER},
				#{CATEGORY},
				#{GENRE},
				#{BOOKLOCATION}
				)
	</insert>
	<insert id="bookDelete"
			parameterType="com.library.eng.service.Discardbooks">
			INSERT INTO discardbooks(
				BOOKCODE, 
				DISCARDREASON)
			VALUES(
				#{BOOKCODE},
				#{DISCARDREASON}
				)
	</insert>
	<update id="updateBookStatus"
			parameterType="com.library.eng.service.Books">
			UPDATE 
				books 
			SET 
				CURRENTSTATUS = 'n'
			WHERE  
				BOOKCODE = #{BOOKCODE}
	</update>
	<insert id="insertRental"
			parameterType="com.library.eng.service.Rental"
			useGeneratedKeys="true"
			keyProperty="RENTALCODE">
			INSERT INTO rental(
				BOOKCODE,
				RENTALSTARTDAY,
				RETURNEXPECTDAY,
				MEMBERID,
				RETURNSTATUS)
			VALUES(
				#{BOOKCODE},
				now(),
				date_add(now(), interval 5 day),
				#{MEMBERID},
				'n')
	</insert>
	<!-- <select id="selectCost"
			resultType="com.library.eng.service.Cost">
			SELECT
				MEMBERRENTALCOST,
				NONMEMBERRENTALCOST
			FROM
				COST
	</select> -->
	<insert id="insertPayment"
			parameterType="com.library.eng.service.Payment">
			INSERT INTO	payment(
				RENTALCODE,
				MEMBERID,
				PAYMENTDAY,
				PAYMENTPRICE)
			VALUES(
				#{RENTALCODE},
				#{MEMBERID},
				#{PAYMENTDAY},
				#{PAYMENTPRICE})
	</insert>
</mapper>